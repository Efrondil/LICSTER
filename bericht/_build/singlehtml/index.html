

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="de" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="de" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>LICSTER 2020 Dokumentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/translations.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Stichwortverzeichnis" href="genindex.html" />
    <link rel="search" title="Suche" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> LICSTER
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-einleitung">1. Einleitung</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-kommunikation">2. Workflow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#jitsi">2.1. Jitsi</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#discord">2.2. Discord</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#jira">2.3. Jira</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-ids">3. Intrusion Detection System</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#unser-team">3.1. Unser Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#einrichtung-pi">3.2. Einrichtung Pi</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#einrichtung-vm">3.3. Einrichtung VM</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#was-ist-ein-ids">3.4. Was ist ein IDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#wieso-man-es-braucht">3.5. Wieso man es braucht</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#arten-von-ids">3.6. Arten von IDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#wireshark">3.7. Wireshark</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#snort">3.8. Snort</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#unsere-snort-regeln">3.9. Unsere Snort Regeln</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-seccom">4. Secure Communication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#einleitung">4.1. Einleitung</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#secure-layer">4.2. Secure Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#remote-io">4.3. Remote-IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#zertifikate">4.4. Zertifikate</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#fazit-und-ausblick">4.5. Fazit und Ausblick</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-webapp">5. Webapplikation Backend</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#einleitung">5.1. Einleitung</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#anfangsstand">5.2. Anfangsstand</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#veranderungen">5.3. Veränderungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#erweiterungen">5.4. Erweiterungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#fazit-und-ausblick">5.5. Fazit und Ausblick</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-probleme">6. Probleme</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#zugriff-auf-das-licster">6.1. Zugriff auf das LICSTER</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#projekttag">6.2. Projekttag</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">LICSTER</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>LICSTER 2020 Dokumentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="licster">
<h1>LICSTER<a class="headerlink" href="#licster" title="Link zu dieser Überschrift">¶</a></h1>
<div class="line-block">
<div class="line">Hochschule Augsburg</div>
<div class="line">Fakultät für Informatik</div>
<div class="line">Projektarbeit</div>
<div class="line">Sommersemester 2020</div>
</div>
<div class="section" id="team">
<h2><strong>Team</strong><a class="headerlink" href="#team" title="Link zu dieser Überschrift">¶</a></h2>
<div class="line-block">
<div class="line">Fabian Klemm, &lt;&gt;</div>
<div class="line">Eric Hoffmann, &lt;<a class="reference external" href="mailto:Eric&#46;Hoffmann1&#37;&#52;&#48;hs-augsburg&#46;de">Eric<span>&#46;</span>Hoffmann1<span>&#64;</span>hs-augsburg<span>&#46;</span>de</a>&gt;</div>
<div class="line">Raphael Hausmanninger, &lt;<a class="reference external" href="mailto:Raphael&#46;Hausmanninger&#37;&#52;&#48;hs-augsburg&#46;de">Raphael<span>&#46;</span>Hausmanninger<span>&#64;</span>hs-augsburg<span>&#46;</span>de</a>&gt;</div>
<div class="line">Michael Janzer, &lt;&gt;</div>
<div class="line">Muhammet Bilbey &lt;&gt;</div>
<div class="line">Athanasios Luludis &lt;&gt;</div>
<div class="line">Janis Schickram, &lt;<a class="reference external" href="mailto:Janis&#46;Schickram&#37;&#52;&#48;hs-augsburg&#46;de">Janis<span>&#46;</span>Schickram<span>&#64;</span>hs-augsburg<span>&#46;</span>de</a>&gt;</div>
</div>
<p>Inhalt:</p>
<div class="toctree-wrapper compound">
<span id="document-einleitung"></span><div class="section" id="einleitung">
<h3><span class="section-number">1. </span>Einleitung<a class="headerlink" href="#einleitung" title="Link zu dieser Überschrift">¶</a></h3>
<p>Industriekontrollsysteme sind heutzutage sehr weit verbreitet und elementar wichtig für die Wirtschaft sowie die Infrastruktur. Durch die Digitalisierung werden diese immer enger mit einander verbunden um einen Fernzugriff bzw. eine Überwachung zu ermöglichen. Da es jedoch mehr Schwachstellen gibt, wächst das Risiko eines Angriffes stark. Ziel dieses Projektes ist es ein günstiges Testbed zu schaffen, um die Sicherheit von Industriekontrollsystemen zu erhöhen.</p>
<p>Am Afang des Projektes haben wir eine klare Gruppeneinteilung zu den jeweiligen Unterprojekten (IDS, SecCom und Web-Applikation) gemacht. Dies hatte zur Folge dass auch unter den Gruppen viel kommuniziert werden musste.</p>
</div>
<span id="document-kommunikation"></span><div class="section" id="workflow">
<h3><span class="section-number">2. </span>Workflow<a class="headerlink" href="#workflow" title="Link zu dieser Überschrift">¶</a></h3>
<p>Jedes Projekt sollte damit es erfolgreich wird einen einheitlichen Workflow besitzen.
Dieser dient zur Planung, Nutzung der Ressourcen und damit das Ziel vom Projekt nicht
verfehlt wird. Zur Kommunikation im Team nützten wir verschiedene Technologien und
Vorgehensweisen, um eine möglichst gute kooperative Arbeitsweise zu ermöglichen.
Diese Strategien werden im Folgenden genauer erklärt.</p>
<div class="section" id="jitsi">
<h4><span class="section-number">2.1. </span>Jitsi<a class="headerlink" href="#jitsi" title="Link zu dieser Überschrift">¶</a></h4>
<p>Um die Kommunikation mit dem Professor herzustellen wurde das Tool jitsi benützt.
Der Vorteil dabei liegt darin das man sich keinen Account erstellen muss.
Somit wurde es ermöglicht das jeder leicht an den Meetings teilnehmen konnte.
Das Meeting mit dem Professor war standartmäßig immer am Donnerstag um 17:30.</p>
</div>
<div class="section" id="discord">
<h4><span class="section-number">2.2. </span>Discord<a class="headerlink" href="#discord" title="Link zu dieser Überschrift">¶</a></h4>
<p>Zur Besprechung und falls es Themen gibt, die mit dem Team besprochen werden mussten
wurde Discord benützt. Dabei wurden mehrere Text Kanäle und sprach Kanäle erstellt,
die man benutzten, kann. Bei den Text Kanälen wurde drauf geachtet das jeder punkt
einen eigenen Kanal hat. Dies haben wir getan damit eine gute Übersicht gewährleistet
wird und man somit auch bei einem späteren Zeitpunkt die Informationen leicht nachschauen
kann die man braucht.</p>
<img alt="_images/Discord.png" src="_images/Discord.png" />
</div>
<div class="section" id="jira">
<h4><span class="section-number">2.3. </span>Jira<a class="headerlink" href="#jira" title="Link zu dieser Überschrift">¶</a></h4>
<p>Für die zentrale Verwaltung der aufgaben wurde das Tool jira benützt. Dabei wurde mit
dem Scrum Prinzip gearbeitet. In Scrum arbeitet man mit sogenannten Sprints. Diese
bestimmen einen Zeitraum, bei uns 1-2 Wochen, in der bestimmte Aufgaben erledigt
werden müssen. Die Arbeitsweise funktionierte so dass man sich am Anfang einer jeden
Woche drauf geeinigt hat welche aufgaben erledigt werden müssen diese wurden dann den
jeweiligen Personen zugewiesen. Ideen oder aufgaben die für diese Woche noch nicht zu
bearbeiten sind oder noch nicht möglich sind zu bearbeiten wurden ins Backlog gesetzt.
Die aufgaben könne dabei drei zustände einnehmen: Aufgabe, wird ausgeführt und fertig.</p>
<img alt="_images/Jira.png" src="_images/Jira.png" />
</div>
</div>
<span id="document-ids"></span><div class="section" id="intrusion-detection-system">
<h3><span class="section-number">3. </span>Intrusion Detection System<a class="headerlink" href="#intrusion-detection-system" title="Link zu dieser Überschrift">¶</a></h3>
<p>In unserer heutigen Zeit nehmen Angriffe auf industriele Systeme stetig weiter zu.
Immer wieder werden neue arten gefunden wie ein System angegriffen werden kann.
Dementsprechend gibt es auch schon sehr viele verschieden Tools die dafür da sind um
zu erkennenden wenn ein Angriff oder ein exploit auf einem System ausgeführt wird und
diesen dann auch dementsprechend zu stoppen:  Software wie Firewalls verhindern dass
nicht autorisierter Datenverkehr in das Netzwerk gelangt, Spam-Filter um unerwünschte
E-Mail-Nachrichten zu verhindern und Antiware-Tools zum Schutz von Endpunkten vor Malware.
All diese Tools werden in so gut wie jedem Unternehmen eingesetzt egal welche Branche
oder wie groß es ist. Ein weiteres wertvolles Sicherheitstool was ebenfalls eingesetzt
wird ist ein Netzwerk-IDS (Intrusion Detection-System). Um dieses geht es auch in unserem
Teil Projekt, bei dem wir ein solches System in dem Testbed Licster implementiert haben.</p>
<div class="section" id="unser-team">
<h4><span class="section-number">3.1. </span>Unser Team<a class="headerlink" href="#unser-team" title="Link zu dieser Überschrift">¶</a></h4>
<p>Unser Team für das Teilprojekt „Intrusion Detection System“ (IDS) besteht aus drei Leuten, die auch schon in ihrem Studium einen starken Fokus auf IT-Sicherheit gelegt haben. Wir haben zusammen mehrerer Kurse in Richtung IT-Sicherheit besucht und teilen uns die Faszination Systeme sicherer machen zu wollen. Deswegen wurde schnell klar, dass unser Team einen großen Wert auf den Sicherheitsaspekt von LICSTER legen wird.
Die Sicherheitslage von Industriesystemen auf der ganzen Welt wird immer kritischer. Bei Angriffen auf diese Systeme können in kürzester Zeit große wirtschaftliche Schäden erzielt werden.</p>
<img alt="_images/cyberattacken.png" src="_images/cyberattacken.png" />
<p>Deswegen haben wir uns zur Aufgabe gemacht, LICSTER eine weitere Sicherheitsschicht hinzuzufügen. Schnell wurde klar, dass ein IDS eine schnelle und aufwandseffiziente Lösung für unsere Problemstellung ist. Ein IDS kann in ein bestehendes System eingebaut werden, ohne dass direkte Änderungen am System gemacht werden müssen. Dies war uns besonders wichtig, da LICSTER bereits vor unserem Projekt schon fertiggestellt war und wir keine konzeptuelle Änderung mehr nachträglich realisieren wollten. Ein bestehendes IDS zu Nutzen hat es uns ermöglicht den zeitlichen Rahmen des Projekts einzuhalten und nützliche Fähigkeiten für unser weiteres Studium zu erlernen.</p>
</div>
<div class="section" id="einrichtung-pi">
<h4><span class="section-number">3.2. </span>Einrichtung Pi<a class="headerlink" href="#einrichtung-pi" title="Link zu dieser Überschrift">¶</a></h4>
<p>Für die Realisierung des IDS wurde sich für ein Raspberry Pi 4 entschieden. Mit 4 GB RAM in der ausgewälten Konfiguration ist das Pi geeignet Snort als IDS laufen zu lassen. Als Betriebssystem wird das Raspberry Pi OS (früher Raspbian genannt) genutzt, welches von der offiziellen Seite bezogen wurde (<a class="reference external" href="https://www.raspberrypi.org/downloads/">https://www.raspberrypi.org/downloads/</a>). Dies wurde mit einem Image-Tool auf eine SD-Karte gespielt und über SSH wurden dann die restlichen Einrichtungen vorgenommen. Nachdem alles eingerichtet war, konnte das Pi in das LICSTER Netzwerk eingesetzt werden. Das Pi wurde an den Mirrorport des Switchs angeschlossen, damit der gesamte Traffic des LICSTERs am Pi empfangen werden kann. Um durch den Dauerbetrieb entstehende Abwärme entgegenzuwirken wurde eine Hülle mit Lüftern für das Pi angeschafft. Im Home-Verzeichnis wurde das Git aus GitLab gecloned. Dieses Repository enthält die Configs und Rules für Snort, sowie weitere Skripte für das IDS.</p>
<img alt="_images/Rapsberry_IDS_Showcase.jpg" src="_images/Rapsberry_IDS_Showcase.jpg" />
</div>
<div class="section" id="einrichtung-vm">
<h4><span class="section-number">3.3. </span>Einrichtung VM<a class="headerlink" href="#einrichtung-vm" title="Link zu dieser Überschrift">¶</a></h4>
<p>Aus Kostengründen konnte nicht für jedes der drei Mitglieder ein Raspberry Pi gekauft werden. Dieses Problem wurde mit Virtuellen Maschinen gelöst. Virtuelle Maschinen emulieren bestimmte Hardware als Software auf einem Hostsystem. Als Virtualisierungssoftware wurde VirtualBox verwendet welches ein Image des Raspberry Pi Desktops nutzte. Somit konnte jedes Mitglied seine eigenes Raspberry Pi simulieren und jede Aufgabe konnte von Jedem erledigt werden. Bei der Einrichtung des Betriebssystems musste auf die bautechnischen Beschränkungen des Raspberry Pi 4 geachtet werden. Somit musste in der VM der Hauptspeicher auf 4 GB RAM beschränkt und der Festplattenspeicher musste auf die 64 GB der eingebauten SD-Karte begrenzt werden.</p>
</div>
<div class="section" id="was-ist-ein-ids">
<h4><span class="section-number">3.4. </span>Was ist ein IDS<a class="headerlink" href="#was-ist-ein-ids" title="Link zu dieser Überschrift">¶</a></h4>
<p>Doch was genau ist nun ein Intrusion Detection system. Eine gute Definition für ein ids
lauten folgend. „Ein IDS (Intrusion Detection System) ist ein Gerät oder eine Anwendung,
mit der der gesamte Netzwerkverkehr überprüft und der Benutzer oder Administrator
benachrichtigt wird, wenn nicht autorisierte Versuche oder Zugriffe stattgefunden haben.“
Im Gegensatz zu einer Firewall welche meist eher als Gatekeeper fungiert also nur den
Netzwerkverkehr überwacht und bestimmt ob er ins Netzwerk darf. Konzentriert sich Ids
System auf den traffic, der im internen Netzwerk abläuft. Dabei wird anhand von
verschieden rule sets geschaut ob ein traffic verdächtig ist bzw. er sich ungewöhnlich
verhält bspw. Modbus mehr traffic in der Sekunde als eigentlich der Standard für das
System ist. Durch diese Weise kann ein ids Angriffe erkennen welche an der Firewall
vorbei kommen oder aus dem eigenem Netzwerk stammen.</p>
</div>
<div class="section" id="wieso-man-es-braucht">
<h4><span class="section-number">3.5. </span>Wieso man es braucht<a class="headerlink" href="#wieso-man-es-braucht" title="Link zu dieser Überschrift">¶</a></h4>
<p>Keine Firewall ist Fehler frei und kein Netzwerk ist undurchdringlich. Angreifer
entwickeln ständig neue Exploits und Angriffstechniken, um auf ein System zu kommen.
Was von fielen Angreifern zusätzlich gerne genutzt wird ist Social Engineering oder
andere arten von Malware. Über diese Methoden gelangen sie meist an Benutzeranmeldeinformationen
und dadurch haben sie nun einen berechtigten zugriff auf das Netzwerk ohne das die
Firewall dies als böswilligen angriff sieht. Ein Network Intrusion Detection System kann
dagegen immer noch sehe was die Person auf dem System macht und falls dabei nun versucht
wird das irgendwelche angriffe ausgeführt werden diese auch erkennen und den System
Administrator zu benachrichtigen das dort was im System nicht stimmt.</p>
<p>Der Haupt Zweck eines ids systems besteht somit darin das It-Personal zu benachrichtigen
falls es einen Angriff oder andere Arten von Bad traffic gefunden hat. Die Kunst für das
Personal besteht nun darin zu schauen welche nachrichtig stimmen und welche ein false
positiv sind.</p>
</div>
<div class="section" id="arten-von-ids">
<h4><span class="section-number">3.6. </span>Arten von IDS<a class="headerlink" href="#arten-von-ids" title="Link zu dieser Überschrift">¶</a></h4>
<p>Im Grundlegen werden zwischen zwei Arten von ids Systemen unterschieden nämlich der signature-based detection
und der anomaly-based detection.</p>
<div class="section" id="signature-based-detection">
<h5><span class="section-number">3.6.1. </span>Signature-based detection<a class="headerlink" href="#signature-based-detection" title="Link zu dieser Überschrift">¶</a></h5>
<p>Bei dieser Methode werden feste Muster verwendet, um den traffic zu kontrollieren.
Diese Muster beschreiben verdächtige Sammlung von Abfolgen von Aktivitäten oder
Operationen, die möglicherweise schädlich sein können. Diese werden dann meist in einer
Datenbank gespeichert. Es werden somit genau definierte Angriffsmuster verwendet,
die die Schwachstelen im System ausnutzten. Die Zeit, die somit gebraucht wird, um den
traffic zu vergleichen ist minimal. Der Hauptvorteil besteht somit darin das Muster oder
Signaturen das Netzwerkverhalten leicht verstehen zu können. Es ist somit effizienter
Angriffe zu verarbeiten die schon bekannt sind.</p>
<p>Die Hauptbeschränkung dieses Systems ist dadurch das Reagieren und Erkennen von Angriffen,
die nicht in der Datenbank gespeichert sind. Somit kann dieses System leicht getäuscht
werden das es nur mit einem bestimmten Satz von ausdrücken oder mit Zeichenfolgenübereinstimmung
arbeiten. Desweitern tuen sich solches System sehr schwer mit Angriffen bei denen
Menschen aktiv etwas tun.</p>
</div>
<div class="section" id="anomaly-based-detection">
<h5><span class="section-number">3.6.2. </span>Anomaly-based detection<a class="headerlink" href="#anomaly-based-detection" title="Link zu dieser Überschrift">¶</a></h5>
<p>Bei diesem System ist das Netzwerkverhalten der Haupt Parameter. Deshalb wird vorerst ein
Model erstellt, welches zeigt wie der normale traffic im Netzwerk aussehen soll.
Dieser kann entweder vorbestimmt werden oder durch vom Netzwerkadministrator festgelegte
Spezifikationen oder Bedingungen mit machine learning gelernt werden. Wenn das
Netzwerkverhalten innerhalb des Models liegt passt alles falls nicht wir eine Wahrung
vom Anomaly detection system ausgelöst.</p>
<p>Das Definieren der Regelsätze ist einer der Hauptnachteile des Anomaly detection systems.
Die Effizienz des Systems hängt von der effektiven Implementierung und dem Testen von
Regelsätzen für alle Protokolle ab. Darüber hinaus wirken sich verschiedene Protokolle
verschieden stark auf das System aus. Des Weiteren hat das System Probleme dabei wen das
böswillige Verhalten unter das akzeptierende Verhalten fällt.</p>
</div>
</div>
<div class="section" id="wireshark">
<h4><span class="section-number">3.7. </span>Wireshark<a class="headerlink" href="#wireshark" title="Link zu dieser Überschrift">¶</a></h4>
<p>Um einen Überblick über die Pakete, die im LICSTER Netzwerk unterwegs sind, zu
bekommen, haben wir, mit Wireshark, den Netzwerkverkehr aufgezeichnet.</p>
<p>Als erstes haben wir pcaps während dem Einschalten, Betrieb und Abschalten von dem Testbed, mithilfe des Mirror Ports erstellt,
um zu sehen was während einem Regulären betrieb auf dem Netzwerk passiert.</p>
<img alt="_images/wireshark_normal.png" src="_images/wireshark_normal.png" />
<p>Als nächstes haben wir pcaps von Angriffen, die wir Durchgeführt haben, aufgezeichnet, um Regeln für unser Intrusion-Detection-System entwickeln zu können.</p>
<img alt="_images/wireshark_flood.png" src="_images/wireshark_flood.png" />
<div class="section" id="durchgefuhrte-angriffe">
<h5><span class="section-number">3.7.1. </span>Durchgeführte Angriffe<a class="headerlink" href="#durchgefuhrte-angriffe" title="Link zu dieser Überschrift">¶</a></h5>
<p>Die Skripte für die Angriffe sind im Offiziellen Github Repository zu finden (<a class="reference external" href="https://github.com/hsainnos/LICSTER/tree/master/attacks">https://github.com/hsainnos/LICSTER/tree/master/attacks</a>).</p>
<div class="section" id="flooding">
<h6><span class="section-number">3.7.1.1. </span>Flooding<a class="headerlink" href="#flooding" title="Link zu dieser Überschrift">¶</a></h6>
<p>Flooding ist eine einfache und beliebte Art eines Denial-of-Service Angriffs.
Für den Angriff haben wir hping3 benutzt. Ein Einfaches CLI-tool um Pakete zu versenden.</p>
<p>Hier wird eins der beiden RemoteIO’s vom LICSTER Testbed geflutet.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo hping3 --flood 192.168.0.51
</pre></div>
</div>
</div>
<div class="section" id="angriff-auf-das-flieszband">
<h6><span class="section-number">3.7.1.2. </span>Angriff auf das Fließband<a class="headerlink" href="#angriff-auf-das-flieszband" title="Link zu dieser Überschrift">¶</a></h6>
<p>Hier haben wir mit einem kleinen Python-Skript das Fließband vom LICSTER Testbed angegriffen und zum stoppen gebracht.
Ausgeführt wird er mit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo ./conveyer_belt.py
</pre></div>
</div>
</div>
<div class="section" id="angriff-auf-die-manuelle-kontrolle">
<h6><span class="section-number">3.7.1.3. </span>Angriff auf die manuelle Kontrolle<a class="headerlink" href="#angriff-auf-die-manuelle-kontrolle" title="Link zu dieser Überschrift">¶</a></h6>
<p>Hier wird, mit einem Python-Skript, die manuelle Kontrolle vom LICSTER Testbed übernommen.
Ausgeführt wird er mit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python3 -i client.py
&gt;&gt;&gt;
</pre></div>
</div>
<p>Anschließend kann man dann Befehle senden um das Testbed zu steuern.</p>
</div>
</div>
</div>
<div class="section" id="snort">
<h4><span class="section-number">3.8. </span>Snort<a class="headerlink" href="#snort" title="Link zu dieser Überschrift">¶</a></h4>
<div class="section" id="wieso-snort">
<h5><span class="section-number">3.8.1. </span>Wieso Snort?<a class="headerlink" href="#wieso-snort" title="Link zu dieser Überschrift">¶</a></h5>
<p>Es wurde sich für Snort entschieden, da es schon seit längerem auf dem Markt verfügbar ist. Dank dieser Zeit ist Snort sehr ausgereift und auch weit verbreitet. Es ist kostenlos und durch seine große Community ist es leicht bei Problemen Unterstützung zu bekommen. Ein weiterer Punkt, warum sich für Snort entschieden wurde, ist, dass bereits einige Gruppenmitglieder sich ein wenig mit den Regeln auskannten. Die Syntax der Regeln ist leicht zu verstehen, bieten aber dennoch die nötige Komplexität, um aussagekräftige Meldungen zu bekommen.</p>
</div>
<div class="section" id="snort-einrichtung">
<h5><span class="section-number">3.8.2. </span>Snort Einrichtung<a class="headerlink" href="#snort-einrichtung" title="Link zu dieser Überschrift">¶</a></h5>
<p>Als Erstes hat jedes Gruppenmitglied Snort bei seiner eigenen VM eingerichtet. So konnten schon die ersten Erfahrungen mit den Regeln und der Funktion von Snort gesammelt werden. Dann wurde abgewogen, welche Snort Version am geeignetsten für das Vorhaben ist. Zur Auswahl standen v2 und v3. Die neuere Version v3 besitzt neue Funktionen, aber dies kommt auch mit Performanceeinbußen einher. Da das Raspberry Pi 4 nur begrenzte Rechenleistung und Hauptspeicher besitzt, wurde sich für die ausgereiftere v2 entschieden. Snort wurde über apt install snort bezogen und war dann auch bereit für den Einsatz. Um die gleichen Konfigurationen und Regeln zu haben, wurde ein GitLab Repository eingerichtet welches alle Konfigurationsdateien und Regeln beinhaltet. Somit musste, um Snort zu starten, nur noch der Pfad zu der Konfiguration angegeben werden. Diese Konfigurationsdatei beinhaltete wiederrum die relativen Pfade zu den Regeln im Repository. Nach der Einrichtung sieht der Befehl zum Starten von Snort so aus: sudo snort -c /path/to/snort.conf</p>
</div>
<div class="section" id="snort-regeln">
<h5><span class="section-number">3.8.3. </span>Snort Regeln<a class="headerlink" href="#snort-regeln" title="Link zu dieser Überschrift">¶</a></h5>
<p>Damit Snort Angriffe/Abnormalitäten erkennen kann, müssen Regeln vorhanden sein, wonach Snort sich richten kann. Darauf Achten sollte man, dass man nicht zu viele Regeln implementiert, denn so kann es passieren, das Snort zu viele Alarme wirft, von denen viele  falsch sind und der echte Alarm untergeht (Man sieht den Angriff vor lauter „Angriffe“ nicht mehr). Hat man aber zu wenige Regel implementiert, kann es passieren, dass mögliche Angriffe nicht erkannt werden. Es müssen also so wenig Regeln wie möglich, aber so viele wie nötig implementiert werden um Fehlalarme zu vermeiden und dennoch echte Angriffe erkennen zu können.</p>
<div class="section" id="regel-schreiben">
<h6><span class="section-number">3.8.3.1. </span>Regel schreiben<a class="headerlink" href="#regel-schreiben" title="Link zu dieser Überschrift">¶</a></h6>
<p>Damit man Regeln schreiben kann muss man erst verstehen wie eine Regel
aufgebaut ist. Hier Hilft die offizielle Anleitung
(<a class="reference external" href="http://manual-snort-org.s3-website-us-east-1.amazonaws.com/node27.html">http://manual-snort-org.s3-website-us-east-1.amazonaws.com/node27.html</a>).</p>
<p>Hier in Kurzfassung:</p>
<p>Eine Regel besteht aus drei Teilen:</p>
<ul class="simple">
<li><p>Aktion</p></li>
<li><p>Kopf</p></li>
<li><p>Regeloptionen</p></li>
</ul>
</div>
<div class="section" id="aktion">
<h6><span class="section-number">3.8.3.2. </span>Aktion<a class="headerlink" href="#aktion" title="Link zu dieser Überschrift">¶</a></h6>
<p>Hier wird angegeben was Snort tun soll, wenn es ein Paket findet, das den
Regel Kriterien entspricht. Es gibt 3 verfügbare Standardaktionen in Snort,
alert, log und pass. Wenn Snort im inline-modus ausgeführt wird, stehen drop,
reject und sdrop zur verfügung.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'alert'</span></code> erzeugt einen Alarm mit der gewählten Alarm Methode und protokolliert dann das Paket</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'log'</span></code> das Paket protokollieren</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pass'</span></code> das Paket ignorieren</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'drop'</span></code> das Paket blockieren und protokollieren</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'reject'</span></code> das Paket blockieren, protokollieren und senden eines TCP-Reset, wenn das Protokoll TCP ist, oder eine ICMP-Port-Unerreichbarkeit Meldung, wenn das Protokoll UDP ist.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sdrop'</span></code> das Paket blockieren, aber nicht protokollieren</p></li>
</ul>
</div>
<div class="section" id="kopf">
<h6><span class="section-number">3.8.3.3. </span>Kopf<a class="headerlink" href="#kopf" title="Link zu dieser Überschrift">¶</a></h6>
<p>Dieses Feld steht für das Protokoll, die IP Adresse, die Ports und die
Richtungsanweisung.</p>
<p><strong>Protokolle</strong></p>
<p>Es gibt vier Protokolle, die Snort auf verdächtiges Verhalten analysiert: TCP,
UDP, ICMP und IP.</p>
<p><strong>IP Adressen und Ports</strong></p>
<p>Der nächste Teil des Regelkopfes befasst sich mit der IP-Adresse und den Port
für eine bestimmte Regel. Man kann das Heimnetzwerk in der Konfigurationsdatei
von Snort festlegen. Das Schlüsselwort any kann zur Definition einer beliebigen
Adresse verwendet werden.</p>
</div>
<div class="section" id="regeloptionen">
<h6><span class="section-number">3.8.3.4. </span>Regeloptionen<a class="headerlink" href="#regeloptionen" title="Link zu dieser Überschrift">¶</a></h6>
<p>Alle Regeloptionen werden durch das Semikolon (;) voneinander getrennt.
Es gibt vier Kategorien von Regeloptionen:</p>
<ul class="simple">
<li><dl class="simple">
<dt>general</dt><dd><p>enthält extra Informationen über die Regel, haben aber keine auswirkung während der Erkennung</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>payload</dt><dd><p>diese Optionen schauen in den Packet-Payload rein</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>non-payload</dt><dd><p>diese Optionen schauen für nicht payload Daten</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>post-detection</dt><dd><p>diese Optionen sind Regelspezifische trigger, die ausgeführt werden, nachdem eine Regel ausgelöst wird</p>
</dd>
</dl>
</li>
</ul>
<img alt="_images/rules.png" src="_images/rules.png" />
<p>Für genauere Regeloptionen schaut man hier am besten nach:
<a class="reference external" href="http://manual-snort-org.s3-website-us-east-1.amazonaws.com/node32.html">http://manual-snort-org.s3-website-us-east-1.amazonaws.com/node32.html</a></p>
</div>
</div>
</div>
<div class="section" id="unsere-snort-regeln">
<h4><span class="section-number">3.9. </span>Unsere Snort Regeln<a class="headerlink" href="#unsere-snort-regeln" title="Link zu dieser Überschrift">¶</a></h4>
<div class="section" id="http-regeln">
<h5><span class="section-number">3.9.1. </span>HTTP Regeln<a class="headerlink" href="#http-regeln" title="Link zu dieser Überschrift">¶</a></h5>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>alert tcp !$HOME_NET any -&gt; 192.168.0.10 $HTTP_PORTS (msg:&quot;HTTP Get from EXTERNAL to 192.168.0.10&quot;; \
classtype: bad-unknown; content: &quot;HTTP&quot;; sid 1002000; rev: 1;)
</pre></div>
</div>
<p>Diese Regel ist dafür da, falls von einem Außenstehenden Netzwerk ein HTTP GET request empfangen worden ist.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>alert tcp !192.168.20 any -&gt; 192.168.30 $HTTP_PORTS (msg:&quot;HTTP Get not from 192.168.0.20 to 192.168.0.30&quot;; \
classtype: bad-unknown; content: &quot;HTTP&quot;; sid 1002005; rev: 1;)
</pre></div>
</div>
<p>Hier ähnlich wie bei der vorherigen Regel, nur wird hier der Alarm geworfen, falls das GET request vom Heimnetz, aber nicht vom HMI, kommt.</p>
</div>
<div class="section" id="icmp-regel">
<h5><span class="section-number">3.9.2. </span>ICMP Regel<a class="headerlink" href="#icmp-regel" title="Link zu dieser Überschrift">¶</a></h5>
<p><strong>Portscan</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alert</span> <span class="n">icmp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="o">-&gt;</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.10</span> <span class="nb">any</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">&quot;Ping nmap Portscan 192.168.0.10&quot;</span><span class="p">;</span> \
<span class="n">dsize</span><span class="p">:</span><span class="mi">0</span><span class="p">;</span> <span class="n">itype</span><span class="p">:</span><span class="mi">8</span><span class="p">;</span> <span class="n">classtype</span><span class="p">:</span> <span class="n">network</span><span class="o">-</span><span class="n">scan</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">1003000</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></div>
</div>
<p>ICMP-Fehlermeldungen (Protocol/Port Unreachable) können verwendet werden, um die offenen Ports zu einer IP-Adresse herauszufinden.
Da die Paketgröße 0 ist wird hier <code class="docutils literal notranslate"><span class="pre">'dsize'</span></code> auf 0 gesetzt und der <code class="docutils literal notranslate"><span class="pre">'itype'</span></code> auf 8, da der Typ 8 für Echo Request steht.</p>
<p><strong>DoS</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alert</span> <span class="n">icmp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="o">-&gt;</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.10</span> <span class="nb">any</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">&quot;Ping flood detected 192.168.0.10&quot;</span><span class="p">;</span> \
<span class="n">itype</span><span class="p">:</span><span class="mi">8</span><span class="p">;</span> <span class="n">count</span> <span class="mi">20</span><span class="p">,</span> <span class="n">seconds</span> <span class="mi">1</span><span class="p">;</span> <span class="n">classtype</span><span class="p">:</span> <span class="n">denial</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">service</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">1003010</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></div>
</div>
<p>Standard DoS Ping flood.</p>
<p><strong>DoS Teardrop</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alert</span> <span class="n">icmp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="o">-&gt;</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.10</span> <span class="nb">any</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">&quot;ICMP Teardrop attack 192.168.0.10&quot;</span><span class="p">;</span> \
<span class="n">fragbits</span><span class="p">:</span><span class="n">M</span><span class="p">;</span> <span class="n">classtype</span><span class="p">:</span> <span class="n">denial</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">service</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">1003020</span><span class="p">;</span><span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></div>
</div>
<p>Teardrop-Angriffe senden Fragmentierte Pakete die nicht wieder zusammengesetzt werden können, das zu einem DoS führen kann. Um den Angriff zu erkennen,
wird hier <code class="docutils literal notranslate"><span class="pre">'fragbits'</span></code> auf <code class="docutils literal notranslate"><span class="pre">'M'</span></code> für more gesetzt, was heißt dass noch mehr Pakete kommen.</p>
<p><strong>ICMP Router Discovery</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alert</span> <span class="n">icmp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="o">-&gt;</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.10</span> <span class="nb">any</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">&quot;ICMP Router Discovery 192.168.0.10&quot;</span><span class="p">;</span> \
<span class="n">icode</span><span class="p">:</span><span class="mi">0</span><span class="p">;</span> <span class="n">itype</span><span class="p">:</span><span class="mi">9</span><span class="p">;</span> <span class="n">classtype</span><span class="p">:</span> <span class="n">network</span><span class="o">-</span><span class="n">scan</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">1003030</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></div>
</div>
<p>Ähnlich wie beim Portscan, nur werden hier nach Benachbarten Routern gesucht. <code class="docutils literal notranslate"><span class="pre">'itype'</span></code> wird auf 9 gesetzt da es für Router Advertisement steht.</p>
<p><strong>ICMP Too large packet</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alert</span> <span class="n">icmp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="o">-&gt;</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.10</span> <span class="nb">any</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">&quot;Large ICMP Packet 192.168.0.10&quot;</span><span class="p">;</span> \
<span class="n">dsize</span><span class="p">:</span><span class="o">&gt;</span><span class="mi">1500</span><span class="p">;</span> <span class="n">classtype</span><span class="p">:</span> <span class="n">denial</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">service</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">1003040</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></div>
</div>
<p>Diese Regel ist dafür da, falls zu große ICMP Pakete gesendet werden. <code class="docutils literal notranslate"><span class="pre">'dsize'</span></code> ist für die Paketgröße und wurde hier auf größer 1500 gesetzt.</p>
</div>
<div class="section" id="modbus-regel">
<h5><span class="section-number">3.9.3. </span>Modbus Regel<a class="headerlink" href="#modbus-regel" title="Link zu dieser Überschrift">¶</a></h5>
<p><strong>DoS</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alert</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="o">-&gt;</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.51</span> <span class="mi">502</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">&quot;Modbus threshold violation 51&quot;</span><span class="p">;</span> <span class="n">threshold</span><span class="p">:</span> \
<span class="nb">type</span> <span class="n">both</span><span class="p">,</span> <span class="n">track</span> <span class="n">by_dst</span><span class="p">,</span> <span class="n">count</span> <span class="mi">60</span><span class="p">,</span> <span class="n">seconds</span> <span class="mi">1</span><span class="p">;</span> <span class="n">classtype</span><span class="p">:</span> <span class="n">successful</span><span class="o">-</span><span class="n">dos</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">1001004</span><span class="p">;)</span>
</pre></div>
</div>
<p>Diese Regel erkennt einen Denial-of-Service Angriff über das Modbus.</p>
</div>
<div class="section" id="ssh-regel">
<h5><span class="section-number">3.9.4. </span>SSH Regel<a class="headerlink" href="#ssh-regel" title="Link zu dieser Überschrift">¶</a></h5>
<p><strong>Strange Traffic</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>alert tcp !$HOME_NET any -&gt; 192.168.0.10 22 (msg:&quot;SSH Request from EXTERNAL NET to 192.168.0.10&quot;; \
content:&quot;SSH&quot;; nocase; offset:0; depth:4; classtype: attempted-user; sid:1000101; rev:1;)
</pre></div>
</div>
<p>Diese Regel erkennt einen SSH Zugriffs versuch aus einem externen Netz.</p>
<p><strong>Brute Force</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alert</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="o">-&gt;</span> <span class="nb">any</span> <span class="mi">22</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">&quot;SSH Brute Force Attempt&quot;</span><span class="p">;</span> <span class="n">flow</span><span class="p">:</span><span class="n">established</span><span class="p">,</span> <span class="n">to_server</span><span class="p">;</span> <span class="n">content</span><span class="p">:</span><span class="s2">&quot;SSH&quot;</span><span class="p">;</span> \
<span class="n">nocase</span><span class="p">;</span> <span class="n">offset</span><span class="p">:</span><span class="mi">0</span><span class="p">;</span> <span class="n">depth</span><span class="p">:</span><span class="mi">4</span><span class="p">;</span> <span class="n">detection_filter</span><span class="p">:</span><span class="n">track</span> <span class="n">by_src</span><span class="p">,</span> <span class="n">count</span> <span class="mi">30</span><span class="p">,</span> <span class="n">seconds</span> <span class="mi">1</span><span class="p">;</span> <span class="n">classtype</span><span class="p">:</span> <span class="n">attempted</span><span class="o">-</span><span class="n">user</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">1000201</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></div>
</div>
<p>Diese Regel erkennt einen SSH Brute Force angriff.</p>
<p><strong>DoS</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alert</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="o">-&gt;</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.10</span> <span class="mi">22</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">&quot;SSH DOS against 192.168.0.10&quot;</span><span class="p">;</span> \
<span class="n">detection_filter</span><span class="p">:</span><span class="n">track</span> <span class="n">by_src</span><span class="p">,</span> <span class="n">count</span> <span class="mi">50</span><span class="p">,</span> <span class="n">seconds</span> <span class="mi">1</span><span class="p">;</span> <span class="n">classtype</span><span class="p">:</span> <span class="n">denial</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">service</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">1000301</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></div>
</div>
<p>Diese Regeln erkennt einen SSH Denial-of-Service angriff.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alert</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="o">-&gt;</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.10</span> <span class="mi">22</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">&quot;SSH DDOS against 192.168.0.10&quot;</span><span class="p">;</span> \
<span class="n">detection_filter</span><span class="p">:</span><span class="n">track</span> <span class="n">by_dst</span><span class="p">,</span> <span class="n">count</span> <span class="mi">500</span><span class="p">,</span> <span class="n">seconds</span> <span class="mi">1</span><span class="p">;</span> <span class="n">classtype</span><span class="p">:</span> <span class="n">denial</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">service</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">1000306</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></div>
</div>
<p>Gleich wie oben, nur ist diese Regel für das Erkennen eines Distributed-Denial-of-Service Angriffs zuständig.</p>
</div>
</div>
</div>
<span id="document-seccom"></span><div class="section" id="secure-communication">
<h3><span class="section-number">4. </span>Secure Communication<a class="headerlink" href="#secure-communication" title="Link zu dieser Überschrift">¶</a></h3>
<div class="section" id="einleitung">
<h4><span class="section-number">4.1. </span>Einleitung<a class="headerlink" href="#einleitung" title="Link zu dieser Überschrift">¶</a></h4>
<p>Als die Secure Communication Gruppe haben wir uns ausschließlich mit der internen Kommunikation des LICSTERs auseinandergesetzt. Als Ziel haben wir es uns gesetzt das bereits implementierte Modbus-Protokoll, das in dieser Form sich als sehr unsicher bewiesen hat, zu verschlüsseln. Dabei haben wir uns dazu entschieden, das TLS-Protokoll einzusetzen. Dieses bietet zusätzlich zu der Verschlüsselung der Anwendungsschicht ein Handshake-Protokoll, das die Authentifizierung der Kommunikationspartner ermöglicht.</p>
<p>Veranschaulichung der ursprünglichen Kommunikation:<span class="raw-html-m2r"><br></span></p>
<a class="reference external image-reference" href="./assets/diagrams/No_Secure_Layer_Overview.png"><img alt="" src="_images/No_Secure_Layer_Overview.png" /></a>
<p>Dies wurde realisiert, indem wir eine zusätzliche Softwareschnittstelle (Secure Layer) im PLC implementiert haben. Diese ermöglicht eine beidseitig verschlüsselte Kommunikation zwischen dem PLC und den Remote-IOs, indem sie eingehende Pakete von den Remote-IOs entschlüsselt und von dem PLC ausgehende Pakete verschlüsselt. Die interne Kommunikation im PLC zwischen dem Secure-Layer und dem OpenPLC findet unverschlüsselt statt.</p>
<p>Veranschaulichung mit Secure Layer:<span class="raw-html-m2r"><br></span></p>
<a class="reference external image-reference" href="./assets/diagrams/Secure_Layer_Overview.png"><img alt="" src="_images/Secure_Layer_Overview.png" /></a>
</div>
<div class="section" id="secure-layer">
<h4><span class="section-number">4.2. </span>Secure Layer<a class="headerlink" href="#secure-layer" title="Link zu dieser Überschrift">¶</a></h4>
<p>Der Secure Layer (sichere Schicht) ist die Komponente die zwischen den Remote-IOs und OpenPLC sitz.</p>
<p>Detaillierte Veranschaulichung:<span class="raw-html-m2r"><br></span></p>
<a class="reference external image-reference" href="./assets/diagrams/Secure_Layer_Details.png"><img alt="" src="_images/Secure_Layer_Details.png" /></a>
<p>Der Secure Layer ist in Python3.6 geschrieben und in 2 Hauptkomponenten zu unterteilen:</p>
<ul class="simple">
<li><p><a class="reference external" href="#bridge">Bridge</a></p></li>
<li><p><a class="reference external" href="#bridgemanager">Bridgemanager</a></p></li>
</ul>
<div class="section" id="id1">
<h5><span class="section-number">4.2.1. </span>Bridge<a class="headerlink" href="#id1" title="Link zu dieser Überschrift">¶</a></h5>
<p>Die Bridge (Brücke) besteht aus zwei TCP Verbindungen, eine TLS Verbindung zu einem Remote TCP Server, und einen lokalen TCP Server der auf eine lokale Verbindung wartet.<span class="raw-html-m2r"><br></span>
Um dies zu ermöglichen muss die Bridge ein wenig Modbus verstehen, da das Message-Framing in diesem Fall durch Informationen im Header vom Modbus Protokoll vorhanden ist.</p>
</div>
<div class="section" id="id2">
<h5><span class="section-number">4.2.2. </span>Bridgemanager<a class="headerlink" href="#id2" title="Link zu dieser Überschrift">¶</a></h5>
<p>Der Bridgemanager (Brückenverwalter) verwaltet die einzelnen Brücken und startet diese bei Fehlern neu.
<span class="raw-html-m2r"><!-- TODO: evtl. ausführlicher --></span></p>
</div>
</div>
<div class="section" id="remote-io">
<h4><span class="section-number">4.3. </span>Remote-IO<a class="headerlink" href="#remote-io" title="Link zu dieser Überschrift">¶</a></h4>
<!-- TODO: evtl. kleine Einleitung bzw. Erläuterung --><div class="section" id="mbed-tls">
<h5><span class="section-number">4.3.1. </span>Mbed TLS<a class="headerlink" href="#mbed-tls" title="Link zu dieser Überschrift">¶</a></h5>
<p>Um TLS auf den Remote-IOs zu implementieren haben wurde die Mbed TLS Bibliothek gewählt, da diese kompakt, portabel und einfach verständlich ist. Hierbei handelt es sich um ein Open-Source Projekt, welches auf GitHub (<a class="reference external" href="https://github.com/ARMmbed/mbedtls">https://github.com/ARMmbed/mbedtls</a>) zu finden ist. Ein weiterer Grund der für Mbed TLS gesprochen hat ist die Tatsache, dass es innerhalb STM32CubeMX konfiguriert werden kann, und dadurch viel Zeit beim konfigurieren der Bibliothek gespart werden kann.</p>
</div>
<div class="section" id="heap-speicher">
<h5><span class="section-number">4.3.2. </span>Heap Speicher<a class="headerlink" href="#heap-speicher" title="Link zu dieser Überschrift">¶</a></h5>
<p>FreeRTOS verwaltet den gesamten Heap Speicher, darum schlagen Aufrufe der Standardbibliotheksfunktionen für dynamische Speicherverwaltung fehl. Das heißt jeder Aufruf an <code class="docutils literal notranslate"><span class="pre">calloc</span></code> oder <code class="docutils literal notranslate"><span class="pre">malloc</span></code> geben <code class="docutils literal notranslate"><span class="pre">NULL</span></code> zurück. Jedoch benötigt Mbed TLS dynamischen Speicher. Explizit benötigt Mbed TLS <code class="docutils literal notranslate"><span class="pre">calloc</span></code> und <code class="docutils literal notranslate"><span class="pre">free</span></code>. Alternativ kann Mbed TLS auch mit einem statischen Block an Speicher arbeiten, jedoch wurde den dynamischen Ansatz gewählt.
<span class="raw-html-m2r"><!-- TODO: WARUM DYNAMISCHER ANSATZ UND NICHT STATISCHER! --></span></p>
<p>Diese Implementation ist in <code class="docutils literal notranslate"><span class="pre">heap_mem.h</span></code> deklariert und in <code class="docutils literal notranslate"><span class="pre">heap_mem.c</span></code> definiert.</p>
<p><code class="docutils literal notranslate"><span class="pre">heap_mem.c</span></code> beinhaltet Folgenden Quellcode:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;heap_mem.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cmsis_os.h&quot;</span><span class="cp"></span>

<span class="k">extern</span> <span class="n">SemaphoreHandle_t</span> <span class="n">alloc_mutex</span><span class="p">;</span>

<span class="kt">void</span><span class="o">*</span> <span class="nf">rmalloc</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">size</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">ptr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">xSemaphoreTake</span><span class="p">(</span><span class="n">alloc_mutex</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">!=</span> <span class="n">pdTRUE</span><span class="p">);</span>
        <span class="n">ptr</span> <span class="o">=</span> <span class="n">pvPortMalloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span>
        <span class="n">xSemaphoreGive</span><span class="p">(</span><span class="n">alloc_mutex</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ptr</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="o">*</span> <span class="nf">rcalloc</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">num</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">size</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">size_t</span> <span class="n">total</span> <span class="o">=</span> <span class="n">num</span> <span class="o">*</span> <span class="n">size</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">ptr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">total</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">xSemaphoreTake</span><span class="p">(</span><span class="n">alloc_mutex</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">!=</span> <span class="n">pdTRUE</span><span class="p">);</span>
        <span class="n">ptr</span> <span class="o">=</span> <span class="n">pvPortMalloc</span><span class="p">(</span><span class="n">total</span><span class="p">);</span>
        <span class="n">xSemaphoreGive</span><span class="p">(</span><span class="n">alloc_mutex</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">total</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
            <span class="p">((</span><span class="kt">uint8_t</span> <span class="o">*</span><span class="p">)</span> <span class="n">ptr</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ptr</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">rfree</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">ptr</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ptr</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">xSemaphoreTake</span><span class="p">(</span><span class="n">alloc_mutex</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">!=</span> <span class="n">pdTRUE</span><span class="p">);</span>
        <span class="n">vPortFree</span><span class="p">(</span><span class="n">ptr</span><span class="p">);</span>
        <span class="n">xSemaphoreGive</span><span class="p">(</span><span class="n">alloc_mutex</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Um diese problemlose Nebenläufigkeit in unserer eigenen Implementierung zu gewährleisten werden alle kritischen Vorgänge mit einem Mutex, bzw. Semaphore abgesichert. Der Code der das gewährleistet ist Folgender:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * Warte bis die Lock von dem Mutext genommen werden kann,</span>
<span class="cm"> * d.h. bis es sicher ist das kein (anderer) Thread</span>
<span class="cm"> * die Lock vom Mutex besitzt.</span>
<span class="cm"> */</span>
<span class="k">while</span> <span class="p">(</span><span class="n">xSemaphoreTake</span><span class="p">(</span><span class="n">net_mutex</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">!=</span> <span class="n">pdTRUE</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Gebe die Lock von dem Mutext ab,</span>
<span class="cm"> * sodass sie von einem (anderen) genommen werden kann.</span>
<span class="cm"> */</span>
<span class="n">xSemaphoreGive</span><span class="p">(</span><span class="n">net_mutex</span><span class="p">);</span>
</pre></div>
</div>
<p>Mbed TLS stellt die folgende Funktion bereit um eigene Implementationen der <code class="docutils literal notranslate"><span class="pre">calloc</span></code> und <code class="docutils literal notranslate"><span class="pre">free</span></code> Funktionen innerhalb Mbed TLS zu verwenden:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">mbedtls_platform_set_calloc_free</span><span class="p">(</span> <span class="kt">void</span> <span class="o">*</span> <span class="p">(</span><span class="o">*</span><span class="n">calloc_func</span><span class="p">)(</span> <span class="kt">size_t</span><span class="p">,</span> <span class="kt">size_t</span> <span class="p">),</span>
                                      <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">free_func</span><span class="p">)(</span> <span class="kt">void</span> <span class="o">*</span> <span class="p">)</span> <span class="p">);</span>
</pre></div>
</div>
<p>Jedoch gilt zu beachten, dass diese Funktion nur aufgerufen werden kann wenn <code class="docutils literal notranslate"><span class="pre">MBEDTLS_PLATFORM_C</span></code> und <code class="docutils literal notranslate"><span class="pre">MBEDTLS_PLATFORM_MEMORY</span></code> definiert sind! Diese wurden in unserem Fall über STM32CubeMX konfiguriert.</p>
<p>Diese Funktion wird in <code class="docutils literal notranslate"><span class="pre">mbedtls.c</span></code> aufgerufen:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;mbedtls.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;mbedtls/platform.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;heap_mem.h&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">MX_MBEDTLS_Init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">mbedtls_platform_set_calloc_free</span><span class="p">(</span><span class="n">rcalloc</span><span class="p">,</span> <span class="n">rfree</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="network-stack">
<h5><span class="section-number">4.3.3. </span>Network Stack<a class="headerlink" href="#network-stack" title="Link zu dieser Überschrift">¶</a></h5>
<p>Um Mbed TLS in den aktuellen LWIP Network Stack einzubringen mussten einige Anpassungen gemacht werden.</p>
<p>LWIP verwendet für die Adressierung der Sockets einen Index.
Dieser Index wird standardmäßig in Mbed TLS nicht richtig adressiert, was dazu führt das alle <code class="docutils literal notranslate"><span class="pre">mbedtls_net_context</span></code> auf den gleichen Socket in LWIP verweisen. Diese Socketverwaltung musste somit selbst implementiert werden.
Dies wurde durch ein einfaches Array umgesetzt:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">char</span> <span class="n">socks</span><span class="p">[</span><span class="n">MEMP_NUM_NETCONN</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">MEMP_NUM_NETCONN</span></code> beschreibt hierbei die Präprozessor für die maximale Anzahl an simultanen Netzwerkverbindungen.<span class="raw-html-m2r"><br></span>
Wenn ein Socketindex aktiv, bzw. reserviert ist wird dieser auf eine Wert der nicht <code class="docutils literal notranslate"><span class="pre">0</span></code> ist (in diesem Fall wird er auf <code class="docutils literal notranslate"><span class="pre">1</span></code> gesetzt).</p>
<p><code class="docutils literal notranslate"><span class="pre">net_sockets.c</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">mbedtls_net_init</span><span class="p">(</span> <span class="n">mbedtls_net_context</span> <span class="o">*</span><span class="n">ctx</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">xSemaphoreTake</span><span class="p">(</span><span class="n">net_mutex</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">!=</span> <span class="n">pdTRUE</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">lwip_initialized</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">MX_LWIP_Init</span><span class="p">();</span>
        <span class="n">lwip_initialized</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">fd</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MEMP_NUM_NETCONN</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">socks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">fd</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
            <span class="n">socks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">xSemaphoreGive</span><span class="p">(</span><span class="n">net_mutex</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Beim freigeben eines <code class="docutils literal notranslate"><span class="pre">mbedtls_net_context</span></code> wird dessen Socketindex auch wieder auf <code class="docutils literal notranslate"><span class="pre">0</span></code> gesetzt, somit ist dieser wieder frei von einem anderen Socket benutzt zu werden.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">mbedtls_net_free</span><span class="p">(</span> <span class="n">mbedtls_net_context</span> <span class="o">*</span><span class="n">ctx</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">fd</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">xSemaphoreTake</span><span class="p">(</span><span class="n">net_mutex</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">!=</span> <span class="n">pdTRUE</span><span class="p">);</span>
    <span class="n">socks</span><span class="p">[</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">fd</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">xSemaphoreGive</span><span class="p">(</span><span class="n">net_mutex</span><span class="p">);</span>
    <span class="n">shutdown</span><span class="p">(</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">fd</span><span class="p">,</span> <span class="mi">2</span> <span class="p">);</span>
    <span class="n">close</span><span class="p">(</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">fd</span> <span class="p">);</span>

    <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">fd</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sowohl beim initialisieren als auch beim freigeben wurde Nebenläufigkeit berücksichtig. Um diese problemlose Nebenläufigkeit in unserer eigenen Implementierung zu gewährleisten werden alle kritischen Vorgänge mit einem Mutex, bzw. Semaphore abgesichert. Der Code der das gewährleistet wird unter <a class="reference external" href="#heap-speicher">Heap Speicher</a> erläutert.</p>
</div>
<div class="section" id="modbus">
<h5><span class="section-number">4.3.4. </span>Modbus<a class="headerlink" href="#modbus" title="Link zu dieser Überschrift">¶</a></h5>
<p>Um die TLS Implementierung optional zu halten wurde viel mit Präprozessoren gearbeitet. Wenn eine bestimmte Präprozessor definiert wird werden bestimmte Sektionen an Code ausgeführt, dadurch kann TLS einfach an- bzw. abgeschaltet werden. Zur Veranschaulichung wie das konkret in Code funktioniert dient folgendes Beispiel:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef USE_TLS</span>
<span class="c1">// Code in diesem Bereich wird nur ausgeführt wenn USE_TLS definiert ist.</span>
<span class="cp">#else</span>
<span class="c1">// Code in diesem Bereich wird nur ausgeführt wenn USE_TLS *nicht* definiert ist.</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p>Konkret wird diese Präprozessor über die Makefile gesetzt, lediglich nur wenn <code class="docutils literal notranslate"><span class="pre">make</span></code> mit <code class="docutils literal notranslate"><span class="pre">config=tls</span></code> aufgerufen wird.</p>
<p>Generell hat sich strukturell nicht viel geändert zur ursprünglichen Modbus Implementation, es wurden lediglich LWIP Funktionen mit denen von Mbed TLS ersetzt, und wenn <code class="docutils literal notranslate"><span class="pre">USE_TLS</span></code> definiert ist wird zusätzlich der TLS Handshake durchgeführt.</p>
</div>
</div>
<div class="section" id="zertifikate">
<h4><span class="section-number">4.4. </span>Zertifikate<a class="headerlink" href="#zertifikate" title="Link zu dieser Überschrift">¶</a></h4>
<p>In <code class="docutils literal notranslate"><span class="pre">./tools/</span></code> wurde ein Bash Skript mit dem Namen <code class="docutils literal notranslate"><span class="pre">create_new_certs_with_ca.sh</span></code> erstellt.
Dieses Skript erstellt eine CA, sowie alle benötigten Zertifikate.
Zur Erstellung dieser Daten werden von Mbed TLS bereitgestellte Programme verwendet (<code class="docutils literal notranslate"><span class="pre">gen_key</span></code> und <code class="docutils literal notranslate"><span class="pre">cert_write</span></code>). Diese sind als Sourcecode auf GitHub zu finden:
<a class="reference external" href="https://github.com/ARMmbed/mbedtls/tree/development/programs">https://github.com/ARMmbed/mbedtls/tree/development/programs</a></p>
<p>Im Anschluss werden die erstellten Zertifikate mit der CA signiert.
Die CA (Certificate Authority) und ihre signierten Zertifikate werden in Ordnern des <a class="reference external" href="#secure-layer">Secure Layers</a> gespeichert.
Daraufhin werden die für die Remote-IOs benötigten Schlüssel und Zertifikate in eine Makefile exportiert, wodurch beim Bauen der Remote-IO Binaries diese alle benötigten Informationen erhalten.</p>
</div>
<div class="section" id="fazit-und-ausblick">
<h4><span class="section-number">4.5. </span>Fazit und Ausblick<a class="headerlink" href="#fazit-und-ausblick" title="Link zu dieser Überschrift">¶</a></h4>
<!-- evtl. überarbeiten --><div class="section" id="fazit">
<h5><span class="section-number">4.5.1. </span>Fazit<a class="headerlink" href="#fazit" title="Link zu dieser Überschrift">¶</a></h5>
<p>Durch die zusätzlichen Implementierungen kann nun optional zwischen der ursprünglich unverschlüsselten Modbus Verbindung und der durch das TLS-Protokoll verschlüsselten Verbindung ausgewählt werden. Zusätzlich zu der verschlüsselten Verbindung übernimmt das Protokoll auch die Überprüfung der Authentizität der Kommunikationspartner. So muss bei einem Verbindungsaufbau das Remote-IO mit einem Zertifikat belegen, dass dieser dem LICSTER-Netzwerk zugehörig ist.</p>
</div>
<div class="section" id="ausblick">
<h5><span class="section-number">4.5.2. </span>Ausblick<a class="headerlink" href="#ausblick" title="Link zu dieser Überschrift">¶</a></h5>
<p>Nach der durch die Verschlüsselung der Kommunikationswege zwischen dem PLC und der Remote-IOs errungenen Sicherheit kann an der Beschleunigung des TLS-Handshakes gearbeitet werden. Durch verwenden eines Secure Elements kann der momentan sehr langsame Verbindungsaufbau von etwa 10 Sekunden beschleunigt werden. Solch ein Microchip würde zusätzliche Sicherheit mit sich bringen, da die Privat Keys dieser unzugänglich sind. Nach der Verbesserung der Performance des Protokolls könnte die sichere Modbus Verbindung auch auf die weiteren Komponenten (HMI und SCADA) des Netzwerkes ausgeweitet werden. Um eine höhere Authentizität im LICSTER-Netzwerk zu erreichen könnte man die Client Authentifizierung derartig erweitern, dass zusätzlich zu den Remote-IOs auch das PLC mithilfe von Zertifikaten seine Zugehörigkeit bestätigen muss.</p>
</div>
</div>
</div>
<span id="document-webapp"></span><div class="section" id="webapplikation-backend">
<h3><span class="section-number">5. </span>Webapplikation Backend<a class="headerlink" href="#webapplikation-backend" title="Link zu dieser Überschrift">¶</a></h3>
<div class="section" id="einleitung">
<h4><span class="section-number">5.1. </span>Einleitung<a class="headerlink" href="#einleitung" title="Link zu dieser Überschrift">¶</a></h4>
<p>Unsere Aufgabe war es die Web-Applikation des LICSTER zu verbessern.</p>
<p>Konkret haben wir das Frontent für mehrere Geräte zugänglich gemacht und das Backend um eine Benutzerverwaltung erweitert. Des weiteren haben wir ein PIN-Feld für das HMI programmiert, die Datenbank der Benutzerverwaltung von der Kommandozeile aufsetzbar gemacht und die Logs des IDS zeigen wir nicht nur auf dem Admin Dashboard an, sondern benachrichtigen Admins auch über Breaches per Email. Ein WSGI (Web Server Gateway Interface) wurde implementiert, um die Einbindung eines Web Servers für Endbenutzer zu vereinfachen.</p>
</div>
<div class="section" id="anfangsstand">
<h4><span class="section-number">5.2. </span>Anfangsstand<a class="headerlink" href="#anfangsstand" title="Link zu dieser Überschrift">¶</a></h4>
<p>Die Flask Applikation der ersten LICSTER Gruppe war ein abgeschlossenes System, welches nur zur Benutzung auf dem HMI konzipiert war. Sie zeigt den Stand aller Servomotoren an, kann Orders anzeigen und plazieren und Motoren einzeln ansteuern.</p>
<p>Sie in einem Unternehmensnetzwerk laufen zu lassen wäre ein Sicherheitsrisiko gewesen, da jeder die Motoren bedienen konnte. Des weiteren würde es Anzeigeprobleme geben, da die Web Applikation nur für einen Bildschirm - den des HMI - programmiert wurde.</p>
<p>Im Folgenden präsentieren wir unsere Veränderungen und Erweiterungen.</p>
</div>
<hr class="docutils" />
<div class="section" id="veranderungen">
<h4><span class="section-number">5.3. </span>Veränderungen<a class="headerlink" href="#veranderungen" title="Link zu dieser Überschrift">¶</a></h4>
<div class="section" id="modularer-aufbau">
<h5><span class="section-number">5.3.1. </span>Modularer Aufbau<a class="headerlink" href="#modularer-aufbau" title="Link zu dieser Überschrift">¶</a></h5>
<p>Die bestehende Webapp war eine Standart Flask App. Da wir sowohl eine Datenbank als auch Wege zum Administrieren und Einloggen hinzufügen wollten, haben wir uns dazu entschlossen der Flask App einen Modularen Aufbau zu geben. Dieser Aufbau wird es auch zukünftigen Gruppen erleichtern sich in die App einzuarbeiten und neue Funktionalitäten hinzuzufügen.</p>
<p>Flask - im Gegensatz zu anderen populären Frameworks wie z.B. Django hat keinen vorgegebenen Applikationsaufbau. Daher kann man wie folgt eine funktionsfähige Flask Web Applikation schreiben, die (sobald die app mit <code class="docutils literal notranslate"><span class="pre">flask</span> <span class="pre">run</span></code> gestartet wurde) unter localhost:5000/ „Hello World!“ anzeigt.</p>
<p>app.py</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;Hello World!&quot;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Mit jeder hinzugefügten Route wird dieses File allerdings unübersichtlicher, weswegen es sich anbietet die App in verschiede Files aufzugliedern. Wir haben uns dafür entschieden die Flask Applikation wie folgt aufzugliedern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">/</span>                <span class="c1"># Alles was direkt mit dem Ablauf der App zu tun hat</span>
<span class="n">app</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>     <span class="c1"># Die Application Factory</span>
<span class="n">app</span><span class="o">/</span><span class="n">admins</span><span class="o">.</span><span class="n">py</span>       <span class="c1"># Alle Administrationsteile der Applikation</span>
<span class="n">app</span><span class="o">/</span><span class="n">auths</span><span class="o">.</span><span class="n">py</span>        <span class="c1"># Alle Authentifikationsteile der Applikation</span>
<span class="n">app</span><span class="o">/</span><span class="n">db</span><span class="o">.</span><span class="n">py</span>           <span class="c1"># Das Handling der Datenbankverbindung</span>
<span class="n">app</span><span class="o">/</span><span class="n">forms</span><span class="o">.</span><span class="n">py</span>        <span class="c1"># Das Handling aller Forms</span>
<span class="n">app</span><span class="o">/</span><span class="n">views</span><span class="o">.</span><span class="n">py</span>        <span class="c1"># Alle Routen zur Bedienung des LICSTER</span>
<span class="n">app</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span>      <span class="c1"># Alle HTML Templates der App</span>
<span class="n">app</span><span class="o">/</span><span class="n">static</span><span class="o">/</span>         <span class="c1"># Die CSS, JavaScript, JQuery und Bootstrap Dateien der App</span>
<span class="n">wsgi</span><span class="o">.</span><span class="n">py</span>             <span class="c1"># Wird benötigt, um die App mit einem WSGI zu starten</span>
</pre></div>
</div>
<p>admins.py, auths.py und views.py sind als Blueprints aufgebaut. Diese Blueprints werden in der main bzw create_app Funktion registriert. Danach funktionieren die Routen der einzelnen Files genauso wie die Routen eines app.py Files.</p>
</div>
<div class="section" id="application-factory">
<h5><span class="section-number">5.3.2. </span>Application Factory<a class="headerlink" href="#application-factory" title="Link zu dieser Überschrift">¶</a></h5>
<p>Eine Application Factory ist eine Funktion, die das globale App Object generiert und zurückgibt. Dies hat verschiedene Vorteile, z.B. ermöglicht es eine einfache Implementierung eines WSGI, das Testen mit verschiedenen globalen Konfigurationen und das einfache Hinzufügen von eigenen CLI Befehlen.</p>
<p>Zur Implementierung der Application Faktory haben wir den Startpunkt der App aus app.py in app/__init__ verlegt. Der Startpunkt ist nun die Funktion create_app(), welche als erstes eine Flask App kreiert, sie dann konfiguriert und als letztes alle Blueprints registriert, bevor sie die App zurückgibt.</p>
</div>
<div class="section" id="design">
<h5><span class="section-number">5.3.3. </span>Design<a class="headerlink" href="#design" title="Link zu dieser Überschrift">¶</a></h5>
<p>Für das Design haben wir uns zusammengesetzt und beschlossen dass ein schlichteres Design ohne viele visuelle Features besser ist. Es handelt sich nämlich um ein IT-Sicherheits-Projekt bei dem natürlich die Sicherheit des Systems an erster Stelle steht und es seriös wirken soll.</p>
<img alt="LICSTER PIN" src="_images/webbapp0.png" />
<p>Für das PIN-Feld wurde eine JavaScript Klasse erstellt, welche für die Anzeige der Tasten und das Handling von Eingaben zuständig ist. Diese Anzeige ist nicht für mehrere Geräte angelegt sondern direkt auf das HMI angepasst.</p>
<img alt="admin" src="_images/webbapp1.gif" />
<p>Die normale Anmeldeseite wurde so realisiert, dass sie auf allen Geräten gut verwendet werden kann.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="erweiterungen">
<h4><span class="section-number">5.4. </span>Erweiterungen<a class="headerlink" href="#erweiterungen" title="Link zu dieser Überschrift">¶</a></h4>
<p>Als zwei Große Erweiterungen wurden das Benutzerverwaltungssytem und der Auswertung und Anzeige der IDS Logs zur Web Applikation hinzugefügt.</p>
<p>Im Benutzerverwaltungssytem gibt es drei Rollen, Admins, Users und nicht angemeldete Personen. Nicht angemeldete Personen haben die Möglichkeit die Startseite der Webapplikation zu besuchen. Andere Webseiten können sie allerdings nicht besuchen, da dies ein Sicherheitsrisiko wäre.</p>
<p>Angemeldete Benutzer können LICSTER wie zuvor auf dem Bildschirm des HMI nun über jedes Gerät, welches ihnen zur Verfügung steht bedienen.</p>
<p>Die dritte Rolle des Benutzverwaltungssystems erlaubt den Zugriff auf das Administratoren Dashboard, wo Benutzer hinzugefügt und gelöscht werden. Hier werden außerdem alle Nutzer tabellarisch angezeigt. Des Weiteren werden tabellarisch IDS Logs auf dem Dashboard angezeigt, falls der Benutzer dies aktiviert hat und bei Hinzufügen einer Email-Adressse zu einem Admin Account wird der Benutzer über Breaches direkt per Email benachrichtigt.</p>
<p>Das Styling der Admin Dashboard-Ansicht wurde mithilfe von HTML und CSS (Cascade Style Sheets) verwirklicht. Hierbei haben wir beschlossen das alle Funktionen auf einer einzigen Seite sind, damit es übersichtlich bleibt und die Bedienung schneller ist.</p>
<img alt="LICSTER WEB" src="_images/webbapp2.png" />
<p>Zusätzlich gibt noch eine Reset-Funktion mit der man alle snort Einträge aus der Datenbank löschen kann.</p>
<div class="section" id="datenbank">
<h5><span class="section-number">5.4.1. </span>Datenbank<a class="headerlink" href="#datenbank" title="Link zu dieser Überschrift">¶</a></h5>
<p>Zur Speicherung der Benutzer, IP Adressen und IDS Logs haben wir eine SQLite Datenbank verwendet, da diese nicht viel Platz braucht und kein Datenbankverwaltungssystem braucht.</p>
<p>Um die Datenbank schnell aufsetzen zu können und das Passwort fürs HMI schnell verändern zu können wurden die Shortcuts <code class="docutils literal notranslate"><span class="pre">flask</span> <span class="pre">init-db</span></code> und <code class="docutils literal notranslate"><span class="pre">flask</span> <span class="pre">change-hmi-password</span></code> implementiert. Wir haben uns gegen Standart Benutzeraccounts und Passwörter entschieden, da diese ein Sicherheitsrisiko darstellen könnten und man die Datenbank normalerweise nur ein einziges Mal aufsetzen muss.</p>
<p>Das Passwort wird beim Erstellen eines Benutzers mit der generate_password_hash Methode von Werkzeug gehasht, der gehashte Wert wird dann gespeichert. Beim Login wird die check_password_hash Methode von Werkzeug verwendet. Wir haben uns gegen die Implementierung eines Salts entschieden, da es uns unsinnig erschien die Datenbank gegen Rainbow Table Attacks zu schützen.</p>
</div>
<div class="section" id="formen">
<h5><span class="section-number">5.4.2. </span>Formen<a class="headerlink" href="#formen" title="Link zu dieser Überschrift">¶</a></h5>
<p>Um CSRF-Attacken, insbesondere Session-Riding Attacken zu verhinden, bei denen Daten mithilfe einer gültigen Sitzung des Opfers manipuliert werden, haben wir für alle Formen FlaskForms verwendet. Dies ist eine im Paket WTForms enthaltene Klasse, welche resistent gegen CSRF-Attacken ist. Jede Subklasse von FlaskForms integriert Tokens in die HTML Formen und überprüft die in der zurückgeschickten Form enthaltenen Tokens mithilfe der validate_on_submit Methode automatisch.</p>
</div>
<div class="section" id="authentication">
<h5><span class="section-number">5.4.3. </span>Authentication<a class="headerlink" href="#authentication" title="Link zu dieser Überschrift">¶</a></h5>
<p>Für alle Routen, die zum An- und Abmelden von Benutzern gehören haben wir das auths Blueprint hinzugefügt.</p>
<p>Die Login-Route überprüft über die validate_on_submit Methode aller FlaskForms, ob eine valide Form gepostet wurde und falls dies nicht der Fall ist wird dem Benutzer eine Form geschickt. Basierend auf die IP Adresse wird dem Benutzer entweder HTML Seite des HMI oder die normale Login Seite geschickt.</p>
<p>Wenn die validate_on_submit Methode True zurückgibt, wird überprüft wer der Benutzer ist. Danach erfolgt ein Passwortabgleich. Falls dieser auch erfolgreich ist wird der Session eine Variable mit der Benutzerrolle
hinzugefügt. Falls sich der Benutzer zum ersten Mal anmeldet, wird er nun weitergeleitet zum Passwort setzen. Andernfalls werden normale Benutzer (also auch HMI Benutzer) zur Startseite weitergeleitet und Administratoren zum Dashboard.</p>
<p>Die Route zum Paswswort überprüft genauso wie die Login Route über die validate_on_submit Methode, ob eine valide Form gepostet wurde und falls dies nicht der Fall ist wird dem Benutzer eine Form geschickt. Wenn der Benutzer ein Passwort eingibt, ersetzt der Hash dieses Passworts den bisherigen Hash in der Datenbank und das Feld für first_login wird auf False bzw. 0 gesetzt.</p>
</div>
<div class="section" id="administration">
<h5><span class="section-number">5.4.4. </span>Administration<a class="headerlink" href="#administration" title="Link zu dieser Überschrift">¶</a></h5>
<p>Für alle Routen, die zur Benutzeradministration gehören haben wir das admins Blueprint hinzugefügt.</p>
<p>Das Admin Dashboard gibt den Administratoren einen Überblick über alle vorhandenen User und alle vorhandenen Logs. Des weiteren gibt es einen Button zum Zurücksetzen der Snort Logs.</p>
<p>Auf dem Admin Dashboard gibt es drei Formen. Die erste Form ist zum Erstellen von Usern. Der Admin muss einen Benutzernamen, ein Passwort und eine Benutzerrolle vergeben. Falls die Benutzerrolle Admin ist, so kann er diesem Benutzer auch eine Email Adresse zuweisen. Zum Löschen eines Benutzers muss der Admin einfach den Benutzernamen in die zweite Form eingeben und auf Löschen klicken. Die letzte Form ist zum Löschen von den Snort Logs.</p>
</div>
<div class="section" id="ids-implementation">
<h5><span class="section-number">5.4.5. </span>IDS Implementation<a class="headerlink" href="#ids-implementation" title="Link zu dieser Überschrift">¶</a></h5>
<p>Zusammen mit dem IDS-Team haben wir an einer Lösung gearbeitet um den Administratoren Zugang zu den Logs zu geben. Dazu haben wir einen Log-Reader geschrieben, welcher die vom IDS übermittelten Logs auf Veränderungen überprüft und neue Daten in die Datenbank einträgt. Auf dem Admin-Dashboard werden diese in einer Tabelle angezeigt. Des Weiteren werden Admins - sofern sie sich mit einer Email-Adresse registriert haben - direkt über Sicherheitsverstöße informiert. Die IDS Implementierung ist eine optionale Funktion.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">**</span><span class="p">]</span> <span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">1001005</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="n">Modbus</span> <span class="n">threshold</span> <span class="n">violation</span> <span class="mi">52</span> <span class="p">[</span><span class="o">**</span><span class="p">]</span>
<span class="p">[</span><span class="n">Classification</span><span class="p">:</span> <span class="n">Attempted</span> <span class="n">Denial</span> <span class="n">of</span> <span class="n">Service</span><span class="p">]</span> <span class="p">[</span><span class="n">Priority</span><span class="p">:</span> <span class="mi">2</span><span class="p">]</span>
<span class="mi">05</span><span class="o">/</span><span class="mi">05</span><span class="o">-</span><span class="mi">13</span><span class="p">:</span><span class="mi">42</span><span class="p">:</span><span class="mf">01.732170</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.30</span><span class="p">:</span><span class="mi">46084</span> <span class="o">-&gt;</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.52</span><span class="p">:</span><span class="mi">502</span>
<span class="n">TCP</span> <span class="n">TTL</span><span class="p">:</span><span class="mi">64</span> <span class="n">TOS</span><span class="p">:</span><span class="mh">0x10</span> <span class="n">ID</span><span class="p">:</span><span class="mi">48012</span> <span class="n">IpLen</span><span class="p">:</span><span class="mi">20</span> <span class="n">DgmLen</span><span class="p">:</span><span class="mi">40</span> <span class="n">DF</span>
<span class="o">***</span><span class="n">A</span><span class="o">****</span> <span class="n">Seq</span><span class="p">:</span> <span class="mh">0x14371674</span>  <span class="n">Ack</span><span class="p">:</span> <span class="mh">0x3ED77</span>  <span class="n">Win</span><span class="p">:</span> <span class="mh">0x7210</span>  <span class="n">TcpLen</span><span class="p">:</span> <span class="mi">20</span>
</pre></div>
</div>
<p>Ein Snort Log Eintrag hat den oben abgebildeten Aufbau. Um auf den Dashboard nur relevante Daten anzuzeigen, filtern wir den Typ, die Klassifikation, die Priorität und den Zeitpunkt aus den Log Einträgen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="n">get_db</span><span class="p">()</span>
<span class="n">last_row</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM snort WHERE   id = (SELECT MAX(id) FROM snort)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>

<span class="k">if</span> <span class="p">(</span><span class="n">last_row</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">last_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Type</span> <span class="ow">or</span> <span class="n">last_row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Classification</span> <span class="ow">or</span> <span class="n">last_row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Priority</span><span class="p">):</span>
    <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;INSERT INTO snort (snort_type, snort_classification, snort_priority, snort_datetime) VALUES (?,?,?,?)&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">Type</span><span class="p">,</span> <span class="n">Classification</span><span class="p">,</span> <span class="n">Priority</span><span class="p">,</span> <span class="n">Datetime</span><span class="p">))</span>
    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>Um Platz in der Datenbank zu sparen und die Email Accounts nicht mit gleichen Warnungen zu überfluten, haben wir uns dazu entschlossen nur neue Logs in der Datenbank zu speichern. Dazu überprüfen wir ob entweder die Datenbank Tabelle leer ist oder der Typ, die Klassifikation oder die Priorität des Logs sich verändert hat. Nur wenn einer der beiden Fälle eintritt, wird ein neuer Eintrag abgespeichert und eine Email versendet.</p>
</div>
<div class="section" id="warnungen-per-mail">
<h5><span class="section-number">5.4.6. </span>Warnungen per Mail<a class="headerlink" href="#warnungen-per-mail" title="Link zu dieser Überschrift">¶</a></h5>
<p>Wenn das Intrusion Detection System Verstöße entdeckt, wird eine Email an alle Administratoren mit einer eingetragenen Email verschickt. Dies wurde mithilfe des smtplib Pakets realisiert. Als Absender haben wir eine dafür dedizierte Email-Adresse verwendet. Diese sensiblen Daten sollten logischerweise nach dem Entwicklungsstadium durch Umgebungsvariablen ausgetauscht werden, da dies ansonsten ein Sicherheitsrisiko darstellen würde.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">smtp</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s1">&#39;licster.breach@gmail.com&#39;</span><span class="p">,</span> <span class="s1">&#39;Lic#v77zX&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="wsgi">
<h5><span class="section-number">5.4.7. </span>WSGI<a class="headerlink" href="#wsgi" title="Link zu dieser Überschrift">¶</a></h5>
<p>Um die leichte Einbindung in einen Server wie nginx zu gewährtleisten, haben wir uns dazu entschlossen ein WSGI einzubinden. Wir haben Gunicorn ausgewählt und ein wsgi.py File erstellt, welches mit der create_app Funktion eine App kreiert und dann startet.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="fazit-und-ausblick">
<h4><span class="section-number">5.5. </span>Fazit und Ausblick<a class="headerlink" href="#fazit-und-ausblick" title="Link zu dieser Überschrift">¶</a></h4>
<div class="section" id="fazit">
<h5><span class="section-number">5.5.1. </span>Fazit<a class="headerlink" href="#fazit" title="Link zu dieser Überschrift">¶</a></h5>
<p>LICSTER zu verbessern war ein interessantes und forderndes Projekt. Wir mussten uns mit dem Framework Flask auseinandersetzen und in ein bestehendes Projekt einarbeiten. Es hat jedoch auch Spaß gemacht ein bestehendes Projekt durch eigene Funktionalitäten erweitern zu können. Wir haben die Web Applikation geräteübergreifend zugänglich gemacht und ein Benutzerverwaltungssystem hinzugefügt.</p>
</div>
<div class="section" id="ausblick">
<h5><span class="section-number">5.5.2. </span>Ausblick<a class="headerlink" href="#ausblick" title="Link zu dieser Überschrift">¶</a></h5>
<p>Bisher läuft die Server-Client Kommunikation über HTTP. Dies stellt ein Sicherheitsrisiko dar, da Benutzernamen und Passwörter unverschlüsselt über das Netz übertragen werden. Es ist möglich, HTTPS mithilfe von Self-Signed Certificates zu implementieren. Eine Anleitung hierzu kann unter <a class="reference external" href="https://gist.github.com/fntlnz/cf14feb5a46b2eda428e000157447309">https://gist.github.com/fntlnz/cf14feb5a46b2eda428e000157447309</a> gefunden werden. Google Chrome hat spezifische Anforderungen an die Zertifikate, welche Probleme verursachen können. Ein Thread zu diesem Problem kann unter <a class="reference external" href="https://github.com/webpack/webpack-dev-server/issues/854">https://github.com/webpack/webpack-dev-server/issues/854</a> gefunden werden.</p>
<p>Aktuell werden Admins via Email unverzüglich über Sicherheitsverstöße benachrichtigt, das Selbe gilt allerdings nicht für das Admin Dashboard. Eine hilfreiche Erweiterung wäre die Implementierung einer Threadlevel Anzeige auf dem Admin Dashboard. Diese sollte automatisch das Sicherheitslevel updaten. Realisiert werden könnte dies z.B. durch eine Socket-Verbindung zwischen der Web Applikation und den Clients. Eine Anleitung zum Implementieren einer Socket-Verbindung kann unter dem folgenden Link gefunden werden: <a class="reference external" href="https://www.includehelp.com/python/implementation-of-websocket-using-flask-socket-io-in-python.aspx">https://www.includehelp.com/python/implementation-of-websocket-using-flask-socket-io-in-python.aspx</a></p>
</div>
</div>
</div>
<span id="document-probleme"></span><div class="section" id="probleme">
<h3><span class="section-number">6. </span>Probleme<a class="headerlink" href="#probleme" title="Link zu dieser Überschrift">¶</a></h3>
<p>Das Projekt LICSTER wurde 2020 etwas von der COVID-19 Pandemie beinträchtigt, da der physische Zugang zu dem LICSTER-Gerät anfangs nicht möglich war. Dies war der Grund wieso beschlossen wurde den Zugang über andere Wege zu realisieren.</p>
<div class="section" id="zugriff-auf-das-licster">
<h4><span class="section-number">6.1. </span>Zugriff auf das LICSTER<a class="headerlink" href="#zugriff-auf-das-licster" title="Link zu dieser Überschrift">¶</a></h4>
<a class="reference external image-reference" href="https://i.imgur.com/aa2UK60.png"><img alt="LICSTER WEB CONTROL" src="https://i.imgur.com/aa2UK60.png" /></a>
<p>Der physische Zugriff auf das Testsystem welches beim Projektaufseher vor Ort installiert war, wurde durch Teamviewer und SSH ersetzt. Durch diesen Teamviewer Zugriff waren wir dann trotzdem in der Lage das Gerät ein- und auszuschalten und die Kamera zu rebooten.</p>
</div>
<div class="section" id="projekttag">
<h4><span class="section-number">6.2. </span>Projekttag<a class="headerlink" href="#projekttag" title="Link zu dieser Überschrift">¶</a></h4>
<p>Der Projekttag war ebenfalls von der Pandemie beeinträchtigt jedoch war es uns möglich eine gemeinsame Präsentation über Microsoft Powerpoint online zu erstellen und diese auch an unseren Vortrag anzupassen.</p>
</div>
</div>
</div>
<div class="section" id="index">
<h3>Index<a class="headerlink" href="#index" title="Link zu dieser Überschrift">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Stichwortverzeichnis</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Modulindex</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Suche</span></a></p></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Fabian Klemm, Eric Hoffmann, Raphael Hausmanninger, Michael Janzer, Muhammet Bilbey, Athanasios Luludis, Janis Schickram

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>